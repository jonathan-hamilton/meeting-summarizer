# Story S3.3: Segment-Level Speaker Override Interface

**Status:** PENDING ðŸ”„  
**Dependencies:** S3.2 - Speaker CRUD Operations Interface

## Overview

As a user, I want to click on individual transcript segments and reassign them to different speakers so that I can correct AI misidentification where the wrong speaker was detected for specific portions of the conversation.

## Acceptance Criteria

**Segment Override Interface:**

- Click-to-edit functionality available on each transcript segment speaker chip
- Dropdown menu shows all available mapped speakers for reassignment
- Visual indicator on confidence scores when speaker has been manually reassigned to segment
- Confidence percentages marked as invalid when segment speaker assignment is manually overridden
- Real-time updates to speaker mapping counts reflecting segment-level reassignments

**Visual Feedback Requirements:**

- Generic "Speaker 1" labels replaced with actual mapped names in transcript segment displays
- Clear visual distinction between AI-assigned and manually-reassigned segments
- Dynamic count updates in "(X/Y mapped)" counters reflecting current mapping status
- Override status indicators show when segments have been manually corrected

**Integration Requirements:**

- Segment overrides integrate with session-based speaker mapping workflow
- Override changes immediately reflected in main Speaker Mappings section during session
- Segment-level changes preserved only during current browser session
- Manual overrides maintained with session-scoped revert capabilities
- Clear indicators showing temporary nature of segment assignments

## Developer Notes

**Frontend Implementation:**

- Enhance TranscriptDisplay component with clickable speaker chips using Material-UI Select components
- Implement segment-level override state management with React hooks and context
- Create visual indicators for confidence score invalidation using Material-UI icons and styling
- Add real-time count updates for mapping status in SpeakerMappingComponent
- Implement segment selection dropdown with all mapped speakers

**Backend Implementation:**

- Extend SpeakerSegment model to track session-based speaker overrides
- Add segment-level override endpoints for session-scoped persistence (/api/segments/{id}/override)
- Implement confidence score invalidation flags in transcript data
- Create session-based tracking for segment-level speaker changes integrating with S3.1 session system

**Technical Implementation:**

```tsx
interface SpeakerSegmentWithOverride extends SpeakerSegment {
  originalSpeaker?: string;
  isManuallyAssigned?: boolean;
  overriddenAt?: string;
  overriddenBy?: string;
  confidenceInvalidated?: boolean;
}
```

**User Experience Considerations:**

- Hover states on clickable speaker chips for discoverability
- Loading states during segment reassignment operations
- Undo functionality for recent segment changes
- Keyboard navigation support for accessibility

**Time Estimate:** 6-8 hours (moderate complexity UI enhancement)
